--LeetCode Questions: Part 2


------5. Average Time of Process per Machine [Easy]

select machine_id, round((end_time - start_time)/no_of_processes, 3) as processing_time from
(select machine_id
, sum(case when activity_type = 'start' then timestamp end) as start_time
, sum(case when activity_type = 'end' then timestamp end) as end_time
, count(distinct process_id) as no_of_processes
from Activity
group by machine_id) a


------6. Employee Bonus [Easy]

select e.name, b.bonus
from Employee e
left join Bonus b
on e.empId = b.empId
where b.bonus < 1000 or b.bonus is null

------7. Students and Examinations [Easy]

with cte1 as
(select a.*, e.subject_name as subject_name1 from
((select * 
from Students
cross join Subjects) a
left join
Examinations e
on a.student_id = e.student_id and a.subject_name = e.subject_name))

select student_id,student_name, subject_name, count(subject_name1) as attended_exams
from cte1
group by student_id,student_name, subject_name
order by student_id, subject_name

------8. Managers with at Least 5 Direct Reports [Medium]

select manager_name as name from
(select e1.*, e2.name as manager_name 
from Employee e1
inner join Employee e2 
on e1.managerId = e2.id) a
group by managerId, manager_name
having count(a.id) >= 5
